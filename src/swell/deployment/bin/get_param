#!/usr/bin/env python

# (C) Copyright 2021-2022 United States Government as represented by the Administrator of the
# National Aeronautics and Space Administration. All Rights Reserved.
#
# This software is licensed under the terms of the Apache Licence Version 2.0
# which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.

import sys
import click
from tide.config import Config

@click.command()
@click.argument('config')
@click.argument('param')
def main(config, param):
  """Retrieves the specified parameter value from a YAML configuration file.

  Arguments
  ---------
  config: string, required
    Name of the YAML configuration file

  param: string, required
    Pathname of the parameter to be queried. Use a slash ("/") to
    reference nodes within a dictionary (e.g. mydict/a would reference the
    parameter "a" contained in the dictionary "mydict").

  Returns
  -------
  value: str
    Extracted/retrieved value (default: '')

  Return Codes
  ------------
  0: parameter value found
  1: parameter value not found
  """

  # Load the configuration

  cfg  = Config(config)

  # Traverse path to locate parameter

  path = param.strip('/').split('/')

  for key in path[0:-1]:
    if key not in cfg:
      print('')
      sys.exit(1)

    cfg = cfg[key]

  # Print the parameter value

  param = path[-1]

  if param in cfg:
    print(cfg[param])
    sys.exit(0)
  else:
    print('')
    sys.exit(1)

if __name__ == "__main__":
  main()
