# Experiment name and location
experiment_id: x0044-jedi-process_obs
experiment_root: /discover/nobackup/${USER}/JediExperiments/

# suite configuration
suite:
  intial cylc point: 2020-12-14T00
  final cylc point: 2020-12-15T00
  runahead limit: PT24H
  suite name: process_obs
  platform: nccs_discover

# GEOS experiment to get backgrounds from
geos_experiment: x0044
iodabin: /discover/nobackup/drholdaw/JediSwell/bundle/1.0.5/build-intel-impi-release/bin/
geos_obs_dir_template: /discover/nobackup/projects/gmao/dadev/rtodling/archive/$(geos_experiment)/obs/Y%Y/M%m/D%d/H%H/
satbias_dir_template: /discover/nobackup/projects/gmao/dadev/rtodling/archive/$(geos_experiment)/rs/Y%Y/M%m/
combined_obs_template: obs_%Y%m%d%H.nc4
sondes_obs_template: sondes_obs_%Y%m%d%H.nc4
sondes_obs_template_rename: radiosonde_obs_%Y%m%d%H.nc4
sfcship_obs_template: sfcship_obs_%Y%m%d%H.nc4
sfcship_obs_template_rename: ship_obs_%Y%m%d%H.nc4
r2d2_obs_standard_template: .%Y-%m-%dT%H:00:00Z.nc4
geos_obs_offset: PT3H
geos_satbias_offset: PT9H
#gnssro_inputbufr: /archive/input/dao_ops/obs/flk/ncep_g5obs/bufr/GPSRO/Y%Y/M%m/gdas1.${yyyy:2:4}%m%d.t%Hz.gpsro.tm00.bufr_d #FIX YEAR
satbias_org_template: $(geos_experiment).rst.%Y%m%d_%Hz.tar
satbias_template: $(geos_experiment).ana_satbias_rst.%Y%m%d_%Hz.txt
satbiaspc_template: $(geos_experiment).ana_satbiaspc_rst.%Y%m%d_%Hz.txt
tlapse_template: .%Y-%m-%dT%H:00:00Z.tlapse
r2d2_satbias_template: .%Y-%m-%dT%H:00:00Z.satbias

# data assimilation window (to determine which backgrounds are needed)
window_type: 4D
window_length: PT6H
window_offset: PT3H
analysis_forecast_window_offset: -PT3H
pseudo_model_tstep: PT1H

# backgrounds
backgrounds:
  background experiment: x0044    # Experiment that provides the background
  background source: file         # Could be file or model
  background schema: geos         # Schema for r2d2
  background frequency: PT1H      # Frequency of background if coming from file

# resolution
horizontal_resolution: c360

# JEDI Background
# ---------------
BACKGROUND:
  filename: $(cycle_dir)/$(valid_date).$(file_type).nc4  # R2D2

# R2D2 schema
# -----------
R2D2_LOCAL_PATH: /discover/nobackup/${USER}/R2D2DataStore/Local/
R2D2:
  fetch:
    an:
      - file_type: [bkg]
        user_date_format: '%Y%m%d.%H%M%S'
    fc:
      - file_type: [bkg]
        user_date_format: '%Y%m%d.%H%M%S'
    bc:
      - file_type: satbias
        target_file: $(cycle_dir)/$(obs_type).$(date).$(file_type).nc4
      - file_type: tlapse
        target_file: $(cycle_dir)/$(obs_type).$(date).$(file_type).txt
  store:
    fc:
      - file_type: [bkg]
        user_date_format: '%Y%m%d.%H%M%S'
