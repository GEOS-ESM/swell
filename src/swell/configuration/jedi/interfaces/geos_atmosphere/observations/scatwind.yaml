obs operator:
  name: GSISfcModel
  observation alias file: '{{experiment_root}}/{{experiment_id}}/configuration/jedi/interfaces/{{model_component}}/observations/obsop_name_map.yaml'
obs space:
  name: scatwind
  obsdatain:
    engine:
      type: H5File
      obsfile: '{{cycle_dir}}/scatwind.{{window_begin}}.nc4'
  obsdataout:
    engine:
      type: H5File
      obsfile: '{{cycle_dir}}/{{experiment_id}}.scatwind.{{window_begin}}.nc4'
  simulated variables: [windEastward, windNorthward]
obs filters:
# Reject all obs with PreQC mark already set above 3
- filter: PreQC
  maxvalue: 3
  action:
    name: reject
#
# WindSat (289), ASCAT (290), or OSCAT (291) either wind component or velocity greater than 20 m/s, then reject.
- filter: Bounds Check
  filter variables:
  - name: windEastward
  - name: windNorthward
  minvalue: -20
  maxvalue: 20
#
- filter: Bounds Check
  filter variables:
  - name: windEastward
  - name: windNorthward
  test variables:
  - name: ObsFunction/Velocity
  maxvalue: 20.0
  where:
  - variable:
      name: ObsType/windEastward
    is_in: 289, 290, 291
  action:
    name: reject
#
# Similar to satellite winds AMV, reject when obs wind direction is more than 50 degrees different than model.
- filter: Bounds Check
  filter variables:
  - name: windEastward
  - name: windNorthward
  test variables:
  - name: ObsFunction/WindDirAngleDiff
  maxvalue: 50.0
  action:
    name: reject
#
# ASCAT (290), RAPIDSCAT (296)  use a LNVD check.
- filter: Bounds Check
  filter variables:
  - name: windEastward
  - name: windNorthward
  test variables:
  - name: ObsFunction/SatWindsLNVDCheck
  maxvalue: 3
  where:
  - variable:
      name: ObsType/windEastward
    is_in: 290, 296
  action:
    name: reject
#
# Assign the initial observation error (constant value, 3.5 m/s right now).
- filter: BlackList
  filter variables:
  - name: windEastward
  - name: windNorthward
  action:
    name: assign error
    error parameter: 3.5
#
# For OSCAT, ASCAT, RAPIDSCAT, or WindSat, reject when either wind component differs by at least 6 m/s from model.
- filter: Background Check
  filter variables:
  - name: windEastward
  - name: windNorthward
  absolute threshold: 6.0
  where:
  - variable:
      name: ObsType/windEastward
    is_in: 289, 290, 291, 296
  action:
    name: reject
#
- filter: Bounds Check
  filter variables:
  - name: windEastward
  action:
    name: reject
  maxvalue: 5.0
  test variables:
  - name: ObsFunction/ObsErrorFactorQuotient
    options:
      numerator:
        name: ObsErrorData/windEastward   # After inflation step
      denominator:
        name: ObsError/windEastward
#
- filter: Bounds Check
  filter variables:
  - name: windNorthward
  action:
    name: reject
  maxvalue: 5.0
  test variables:
  - name: ObsFunction/ObsErrorFactorQuotient
    options:
      numerator:
        name: ObsErrorData/windNorthward   # After inflation step
      denominator:
        name: ObsError/windNorthward
